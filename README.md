# md2gost

Расширение, позволяющее преобразовывать Markdown-файлы в документы **DOCX** и **PDF**, стараясь соблюдать требования ГОСТа для написания отчётов и курсовых работ.

Расширение работает с файлами формата `.g.md` и добавляет удобные кнопки для быстрого экспорта прямо из редактора.

* [Возможности](#возможности)
* [Требования](#требования)
* [Как использовать](#как-использовать)
* Поддерживаемый синтаксис Markdown:
	* [Текст](#текст)
	* [Заголовки](#заголовки)
	* [Списки](#списки)
	* [Картинки](#картинки)
	* [Листинг](#листинг)
	* [Таблицы](#таблицы)
	* [Коментарии](#коментарии)
* Дополнительный синтаксис:
	* [Оглавление](#оглавление)
	* [Разрыв секции](#разрыв-секции)
	* [Вставка другого docx](#вставка-другого-docx)

## Возможности

* Экспорт Markdown → **DOCX**
* Экспорт Markdown → **PDF**
* Вставка содержимого других DOCX-файлов с заменой текста (например, титульник с заменой темы)
* Автоматическая замена "ИИ" тире на обычные

## Требования

* Установленный **Microsoft Word**. (Без него работает лишь частично)

## Как использовать

1. Создайте и откройте файл с расширением `.g.md`.
2. В панели редактора появятся кнопки экспорта в DOCX и PDF

	![screenshot](./imgs/screenshot_icons.png)

## Поддерживаемый синтаксис

### Текст
Пустая строка разделяет параграфы. В отличие от обычного Markdown перенос строки сохраняется в параграфе.

### Заголовки

```
# Заголовок первого уровня
## Заголовок второго уровня
### и т. д.
```

### Списки
При экспорте автоматически добавляются запятые/точка с запятой у элементов и точка у последнего элемента
```
Не нумерованный список:
* первое
* второе
- можно чертой

Нумерованный список:
1. первое
1. второе
2) можно скобкой

Вложенный список:
1. первое
	* подпункт 1
	* подпункт 2
2. второе
```

### Картинки
Картинкам можно задать размер, указав его в фигурных скобках.
В тексте подписи можно вставить перенос строки с помощью `\n` (т.к. поддерживается только однострочное объявление картинки).

Путь к картинке вычисляется относителено `.g.md` файла

После квадратной скобки пробела быть не должно (тут он стоит из-за некоторых проблем с отображением этого файла)
```
![подпись] (путь/к/файлу.png)
![подпись] (путь/к/файлу.png){ширина x высота}

![Рисунок 1.1 - Пример] (image.png)
![Рисунок 1.2 - С указанием ширины] (image.png){340}
![Рисунок 1.3 - С указанием высоты] (image.png){x265}
![Рисунок 1.4 - С указанием размера] (image.png){340x265}
![Рисунок 1.5 - Важные зарисовки, с очень длинным названием, \nкоторое не умещается в одну строку] (image.png){340}
```


### Листинг
В отличие от обычного Markdown после кода языка в первой строке пишется заголовок листинга (при разрыве листинга на несколько страниц заголовок продублируется автоматически)

Путь к документу вычисляется относителено `.g.md` файла
````
```html Листинг 1.1 - Шаблон html страницы
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
</body>
</html>
```
````

### Таблицы
Параграф перед таблицей считается её подписью и при экспорте соответствующе форматируется
```
Таблица 1 - Результат анализа

Заголовок 1 | Заголовок 2 | Заголовок 3
------------|-------------|------------
текст       | текст       | текст
текст       | текст       | текст
```

### Коментарии
Текст, который исчезнет при экспорте. Поддерживаются только однострочные комментарии.
```
<!-- Коментарий -->
<!-- в две строки -->
```

### Оглавление
Достаточно написать заголовок "Оглавление"
```
# Оглавление
```


### Разрыв секции

Создаёт разрыв секции в документе:

```
!!section
Секция без нумерации страниц

!!section from 3
Секция с нумерацией страниц начиная с 3
```

### Вставка другого DOCX

Вставляет содержимое DOCX-файла с возможностью передачи параметров:

```md
!!(путь/к/фалу.docx){"поле": "значение"}

!!(title.docx){
	"taskN": "1",
	"topic": "Сбалансированные деревья поиска",
	"group": "КЛМН-00-00",
	"name": "Иванов П.С.",
}
```

В импортируемом DOCX-файле полями считается любой текст в двойных фигурных скобках, пример: `{{поле}}`

![screenshot](imgs/screenshot_doc_include.png)